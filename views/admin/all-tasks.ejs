<div class="top-bar">
    <h1>سجل المهام والعمليات</h1>
    <div class="user-info">
        <a href="/admin/add-task" style="background: var(--accent); color: black; padding: 8px 15px; border-radius: 8px; text-decoration: none; font-weight: bold;">
            <i class="fas fa-plus"></i> مهمة جديدة
        </a>
    </div>
</div>

<div style="background: var(--card-bg); padding: 25px; border-radius: 15px;">
    <table style="width: 100%; border-collapse: collapse; text-align: right;">
        <thead>
            <tr style="border-bottom: 2px solid #333; color: #888;">
                <th style="padding: 15px;">العميل</th>
                <th style="padding: 15px;">الفني المسؤول</th>
                <th style="padding: 15px;">نوع المهمة</th>
                <th style="padding: 15px;">الحالة</th>
                <th style="padding: 15px;">تاريخ الإضافة</th>
                <th style="padding: 15px;">العمليات</th>
            </tr>
        </thead>
        <tbody>
            <% tasks.forEach(task => { %>
                <tr style="border-bottom: 1px solid #222; transition: 0.3s;" onmouseover="this.style.backgroundColor='#222'" onmouseout="this.style.backgroundColor='transparent'">
                    <td style="padding: 15px;">
                        <strong style="display: block;"><%= task.clientName %></strong>
                        <small style="color: #666;"><%= task.clientPhone %></small>
                    </td>
                    <td style="padding: 15px;">
                        <%= task.assignedTechnician ? task.assignedTechnician.name : 'غير معين' %>
                    </td>
                    <td style="padding: 15px;">
                        <span style="background: #333; padding: 4px 10px; border-radius: 5px; font-size: 12px;"><%= task.taskType %></span>
                    </td>
                    <td style="padding: 15px;">
                        <% if(task.status === 'قيد الانتظار') { %>
                            <span style="color: #ffb800; background: rgba(255,184,0,0.1); padding: 5px 10px; border-radius: 20px; font-size: 12px;">● قيد الانتظار</span>
                            <% } else if(task.status === 'جاري العمل') { %>
                                <span style="color: #00d1ff; background: rgba(0,209,255,0.1); padding: 5px 10px; border-radius: 20px; font-size: 12px;">● جاري العمل</span>
                                <% } else { %>
                                    <span style="color: #00ff88; background: rgba(0,255,136,0.1); padding: 5px 10px; border-radius: 20px; font-size: 12px;">● مكتملة</span>
                                    <% } %>
                    </td>
                    <td style="padding: 15px; font-size: 13px; color: #666;">
                        <%= task.createdAt.toLocaleDateString('ar-EG') %>
                    </td>
                    <td style="padding: 15px;">
                        <div style="display: flex; gap: 10px;">
                            <button title="عرض التفاصيل" style="background: #333; border: none; color: white; padding: 5px 8px; border-radius: 5px; cursor: pointer;"><i class="fas fa-eye"></i></button>
                            <button title="حذف" style="background: rgba(255,68,68,0.1); border: 1px solid #ff4444; color: #ff4444; padding: 5px 8px; border-radius: 5px; cursor: pointer;"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                </tr>
                <% }) %>
        </tbody>
    </table>
</div>